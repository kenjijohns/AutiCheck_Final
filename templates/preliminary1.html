{% extends 'base.html' %} {% block content %}
<div
  class="form-wrapper flex justify-center items-center mx-auto p-4 h-full mt-2 sm:mt-0"
>
  <form
    method="POST"
    action="{{ url_for('preliminary1') }}"
    class="bg-white shadow-xl rounded-xl px-8 pt-6 pb-8 mb-4 w-full lg:w-1/2"
    id="preliminaryForm"
  >
    <div class="mb-4 relative">
      <label for="gender" class="block text-gray-700 text-sm font-bold mb-2"
        >Sex</label
      >
      <div class="relative">
        <select
          id="gender"
          name="gender"
          class="appearance-none border rounded w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"
        >
          <option value="" selected disabled>--</option>
          <option value="m">Male</option>
          <option value="f">Female</option>
        </select>
        <div
          class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"
        >
          <i class="fa fa-chevron-down"></i>
        </div>
      </div>
    </div>

    <div class="mb-4 relative">
      <label for="ethnicity" class="block text-gray-700 text-sm font-bold mb-2"
        >Ethnicity</label
      >
      <div class="relative">
        <select
          id="ethnicity"
          name="ethnicity"
          class="appearance-none border rounded w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"
        >
          <option value="" selected disabled>--</option>
          <option value="asian">Asian</option>
          <option value="south asian">South Asian</option>
          <option value="black">Black</option>
          <option value="hispanic">Hispanic</option>
          <option value="Latino">Latino</option>
          <option value="middle eastern">Middle Eastern</option>
          <option value="Native Indian">Native Indian</option>
          <option value="Hacifica">Pacifica</option>
          <option value="White European">White European</option>
          <option value="mixed">Mixed</option>
          <option value="Others">Others</option>
        </select>
        <div
          class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"
        >
          <i class="fa fa-chevron-down"></i>
        </div>
      </div>
    </div>

    <div class="mb-4">
      <label for="birthday" class="block text-gray-700 text-sm font-bold mb-2"
        >Birthday</label
      >
      <input
        type="date"
        id="birthday"
        name="birthday"
        class="appearance-none border rounded w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline"
      />
    </div>

    <div class="flex items-center justify-between">
      <a
        href="/"
        class="back-next-button text-center md:w-1/5 w-1/3 bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-xl focus:outline-none focus:shadow-outline"
      >
        Back
      </a>
      <button
        type="button"
        id="submitButton"
        class="back-next-button md:w-1/5 w-1/3 bg-blue-800 hover:bg-blue-900 text-white font-bold py-2 px-4 rounded-xl focus:outline-none focus:shadow-outline"
      >
        Next
      </button>
    </div>
  </form>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const submitButton = document.getElementById("submitButton");
    const form = document.getElementById("preliminaryForm");

    submitButton.addEventListener("click", function () {
      const birthdayInput = document.getElementById("birthday");
      const genderInput = document.getElementById("gender"); // Add this line
      const ethnicityInput = document.getElementById("ethnicity"); // Add this line

      if (!birthdayInput.value || !genderInput.value || !ethnicityInput.value) {
        alert("Please fill out all fields");
        return;
      }

      const birthday = new Date(birthdayInput.value);
      const currentDate = new Date();
      const ageInMonths = Math.floor(
        (currentDate - birthday) / (1000 * 60 * 60 * 24 * 30.44)
      );

      if (ageInMonths < 18 || ageInMonths > 36) {
        alert("The toddler should be between 18 months and 36 months old.");
      } else {
        sessionStorage.setItem("ageInMonths", ageInMonths);
        sessionStorage.setItem(
          "ethnicity",
          ethnicityInput.options[ethnicityInput.selectedIndex].text
        );
        sessionStorage.setItem(
          "sex",
          genderInput.options[genderInput.selectedIndex].text
        );
        form.submit();
      }
    });
  });
</script>

{% endblock %}
